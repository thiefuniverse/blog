#+BLOG: my-blog
#+POSTID: 151
#+ORG2BLOG:
#+DATE: [2017-02-27 Wed 00:08]
#+OPTIONS: toc:4 num:nil todo:nil pri:nil tags:nil ^:nil
#+CATEGORY: coding
#+TAGS: mustache, template
#+TITLE:       Mustache--Logic-Less templates
#+AUTHOR:      thief
#+EMAIL:       thiefuniverses@gmail.com
#+DATE:        2017-02-27
#+URI:         mustache_tempalte
#+KEYWORDS:    mustache
#+TAGS:        template,mustache
#+LANGUAGE:    en
#+OPTIONS:     html-validation-link:nil

* Introduction
  mustacheæ˜¯ä¸€ä¸ªæ¨¡æ¿ä½“ç³»,å®šä¹‰äº†ä¸€ç§å¾ˆç®€å•è€Œå®ç”¨çš„æ¨¡æ¿å®ç°.ä¸‹æ–‡ä¸­ä½ å¯ä»¥çœ‹åˆ°è¿™ä¸ªæ¨¡æ¿ä½“ç³»çš„åŸºæœ¬ç‰¹ç‚¹å’Œpythonå®ç°çš„ä½¿ç”¨æ–¹å¼ï¼

* Basic Theory
(ä»¥ä¸‹ä»£ç ç”¨python3è¿›è¡Œæ¼”ç¤º,ä½¿ç”¨äº†mustacheæ¨¡æ¿çš„pythonå®ç°ï¼Œåº“åå«pystache)
** é€šè¿‡hashè¡¨æ¥èµ‹å€¼åˆ›å»ºæ¨¡æ¿
*** åŸºæœ¬å˜é‡(é”®å€¼)æ¸²æŸ“
   #+BEGIN_SRC python :results output
     {{=<% %>=}}
     import pystache
     print(pystache.render('Hi {{person}}!', {'person': 'Mom'}))
     #    : Hi Mom!
     <%={{ }}=%>
   #+END_SRC

*** å˜é‡çœŸå€¼æ¡ä»¶æ¸²æŸ“
é€šè¿‡åˆ¤æ–­hashtableä¸­é”®å€¼(#åŠ å˜é‡)æ˜¯å¦å­˜åœ¨(å­˜åœ¨å³ä¸ºçœŸå€¼ï¼Œæˆ–è€…å˜é‡åå‰åŠ ^æ—¶åªæœ‰å˜é‡å€¼ä¸ºå‡æ‰æ¸²æŸ“æ¨¡æ¿)ï¼Œæ¥æ¸²æŸ“æ¨¡æ¿ï¼
   #+BEGIN_SRC python :results output
     {{=<% %>=}}
     import pystache
     renderer=pystache.Renderer()
     parsed = pystache.parse(u"Hey {{#who}}{{.}}!{{/who}}")

     print(renderer.render(parsed,{})) # who ä¸å­˜åœ¨æ•…ä¸æ¸²æŸ“whoæ ‡ç­¾éƒ¨åˆ†
     print(renderer.render(parsed,{'who':'thief'}))ã€€#åˆ†åˆ«æ ¹æ®whoçš„å€¼æ¸²æŸ“å‡ºä¸åŒå¥å­
     print(renderer.render(parsed,{'who':'universe'}))

     context = { 'author': 'Chris Wanstrath', 'maintainer': 'Chris Jerdonek' }# ä¸€æ¬¡ä¼ å…¥å¤šä¸ªå€¼
     print(pystache.render("Author: {{author}}\nMaintainer: {{maintainer}}", context))

     print(pystache.render( "{{^is-sunny}}Take an umbrella!{{/is-sunny}}", {'is-sunny':False}))

     # : Hey
     # : Hey thief!
     # : Hey universe!
     # : Author: Chris Wanstrath
     # : Maintainer: Chris Jerdonek
     # : Take an umbrella!
     <%={{ }}=%>
   #+END_SRC

*** æ§åˆ¶è½¬ä¹‰(3*{æˆ–è€…&ç¬¦å·)
å¯¹äºå˜é‡å€¼ï¼Œå¦‚æœæ˜¯<ç­‰å…¶ä»–ä¸€äº›ç‰¹æ®Šå­—ç¬¦ä¼šè¢« *è½¬ä¹‰* ï¼Œç”¨ä¸‰ä¸ªå¤§æ‹¬å·æˆ–è€…&ç¬¦å·å¯ä»¥å–æ¶ˆè½¬ä¹‰ï¼Œä¿ç•™åŸå­—ç¬¦ï¼
   #+BEGIN_SRC python :results output
     {{=<% %>=}}
     import pystache
     renderer=pystache.Renderer()
     parsed = pystache.parse(u"{{company}}\n{{&company}}\n{{{company}}}")

     print(renderer.render(parsed,{'company':'<b>GitHub</b>'}))
     # : &lt;b&gt;GitHub&lt;/b&gt;
     # : <b>GitHub</b>
     # : <b>GitHub</b>

     <%={{ }}=%>
   #+END_SRC

*** åˆ—è¡¨æ¸²æŸ“
å¯¹äºåˆ—è¡¨ï¼Œè¿˜å¯ä»¥ä½œåˆ—è¡¨æ¸²æŸ“ï¼å½“#å˜é‡å­˜åœ¨ï¼Œä¸”hashtableä¸­çš„å€¼å¯¹åº”ä¸ºä¸€ä¸ªåˆ—è¡¨æ—¶ï¼Œmustacheä¼šè¿›è¡Œåˆ—è¡¨æ¸²æŸ“ï¼
åˆ†åˆ«é’ˆå¯¹å€¼åˆ—è¡¨çš„æ¯ä¸ªå…ƒç´ ä¾æ¬¡æ¸²æŸ“å‡ºç»“æœï¼


   #+BEGIN_SRC python :results output
     {{=<% %>=}}
     import pystache
     renderer=pystache.Renderer()
     parsed = pystache.parse(u"{{#repo}}\nhello,{{name}}! you are {{age}}\n{{/repo}}")

     print(renderer.render(parsed,
      		     {'repo':[
                               {"name":"thief","age":33},
                               {"name":"fly","age":88},
                               {"name":"universe","age":99}
      		     ]}))
     #  : hello,thief! you are 33
     #  : hello,fly! you are 88
     #  : hello,universe! you are 99
     <%={{ }}=%>

   #+END_SRC

*** æ³¨é‡Šæ–¹å¼
    #+BEGIN_SRC python
    {{=<% %>=}}
    {{! It is a line for comment }}
    <%={{ }}=%>
    #+END_SRC

*** æ¨¡æ¿åµŒå¥—
    mustacheçš„æ ‡ç­¾æ”¯æŒæ¨¡æ¿åµŒå¥—(å³ä¸€ä¸ªæ¨¡æ¿ä¸­åµŒå…¥å…¶ä»–å¤šä¸ªæ¨¡æ¿).å¦‚ä¸‹æ˜¯ä¸€ä¸ªhtmlæ¨¡æ¿åµŒå¥—çš„ä¾‹å­.
    #+BEGIN_SRC html
      {{=<& &>=}}
      <!-- use > and tags name to embed tags-name.mustache file -->
      <!DOCTYPE html>
      <html lang="en-us">
        {{> header}}
        <body class="wrapper">
          <header>
        {{> person-zone}}
        {{> nav}}
          </header>
          <section id="blog-index">
        {{> blog-index}}
          </section>
          {{> footer}}
        </body>
      </html>
      <&={{ }}=&>
    #+END_SRC

*** æ ‡ç­¾ç¬¦å·ä¿®æ”¹
    mustacheçš„æ ‡ç­¾å¯ä»¥åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ä¿®æ”¹,åŸå§‹ä¸ºä¸¤ä¸ªå¤§æ‹¬å·.

    #+BEGIN_SRC python
      {{=<& &>=}}
      {{default_tags}} #åŸå§‹æ ‡ç­¾
      {{=<% %>=}}   #æ ‡ç­¾æ”¹å˜ä¸ºç­‰å·ä¸­é—´çš„æ–°æ ‡ç­¾
      <% erb_style_tags %>ã€€#åº”ç”¨æ–°æ ‡ç­¾
      <%={{ }}=%> # æŠŠæ ‡ç­¾æ”¹å›é»˜è®¤çš„
      <&={{ }}=&>
    #+END_SRC

*** lambda è¡¨è¾¾å¼æ”¯æŒ
    mustacheæ ‡ç­¾æ”¯æŒlambdaè¡¨è¾¾å¼æ¥æ¸²æŸ“æ”¹å˜æ ‡ç­¾å†…æ–‡å­—.(æœ¬äººå¹¶æœªå®è·µï¼Œæ„Ÿå…´è¶£å¤§å®¶å¯ä»¥è¯•è¯•ğŸ˜†)
